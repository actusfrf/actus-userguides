# Companion User Guide for ACTUS portfolio analysis with interest rate risk scenarios

## Document purpose and overview

This document provides guidance to a user of the ACTUS demonstrations:

- ACTUS portfolio analysis with interest rate risk scenarios – [https://dadfir3.shinyapps.io/DaDFiR3demo](https://dadfir3.shinyapps.io/DaDFiR3demo)

Software demonstrations should be self-explanatory and self-documenting but missing context, and “non-obvious” but required user actions can make exploration of the demo capabilities difficult and frustrating. This “companion” user guide aims to help the user through these obstacles. The demonstration software and in-demo documentation should and will eventually be updated to remove these problems. This user guide provides an immediate fix and documents the issues which should be addressed in improving the demos.

## Portfolio Analysis for Interest Rate Scenarios: A companion user guide

This demo is started either by pointing a browser to [https://dadfir3.shinyapps.io/DaDFiR3demo](https://dadfir3.shinyapps.io/DaDFiR3demo) or by installing a standalone workstation instance of the server and demo following the instructions in [https://github.com/actusfrf/actus-userguides/blob/main/ACTUS-Rshiny-demo/UserGuide.md](https://github.com/actusfrf/actus-userguides/blob/main/ACTUS-Rshiny-demo/UserGuide.md)

The function provided in the demo is essentially the same for both the cloud and locally installed versions. The only difference is that the locally installed standalone version has a configuration option. It can be configured to use the remote publicly available ACTUS server at [https://demo.actusfrf.org:8080](https://demo.actusfrf.org:8080). In this configuration, the ACTUS Rshiny demo application container is running locally on your workstation but it is calling out to a remote server for ACTUS contract simulation. Alternatively, the local demo can be configured to use an ACTUS server in a second docker container running locally on your workstation and using a third container running on your workstation with a MongoDB database for persistent data storage.

The purpose of this demonstration is to show how ACTUS can be used to explore how the cashflow for an ACTUS contract or portfolio of contracts is dependent on the risk factor scenario chosen for the simulation. Interest rate scenarios – reflected by a projected pattern of “future” interest rate values for US 5-year treasury bonds are supported. The variable rate ACTUS contracts use this market index as the basis for their interest rate reset events. Cash flows for different interest rate scenarios can be generated for a single contract or for a portfolio of contracts. In the case of a single contract simulation, a cashflow graph is generated like the output of the Sample ACTUS Contract Cashflows Demo described above. In the case of a portfolio simulation, graphical plots of profit or liquidity over time can be generated.

It is an important part of the ACTUS value proposition, that the income over time and liquidity behavior of a portfolio of ACTUS contracts can be precisely and accurately calculated for any defined market risk scenario. That is what is illustrated in this demo.

### Steps in working this demo:

1. The demo comes up in a display with five tabs in the title bar:
   - Interest Rate Scenarios
   - Loan Contract cashflow
   - Portfolio analysis
   - Uploaded Portfolio Analysis
   - Help
2. ‘Help’ is logically the first tab to open
   - This tab provides a short description of the content of the other tabs.
   - If you are using the – on local workstation – version of the ACTUS-Rshiny-demo, there is an option to configure it to work either with the remote ACTUS server at [https://demo.actusfrf.org

:8080](https://demo.actusfrf.org:8080/) or to a local ACTUS service typically at [http://host.docker.internal:8083/](http://host.docker.internal:8083/). - If you are using the -on Rshiny cloud – version of the ACTUS-RShiny-demo, it is always configured to use the ACTUS server at [https://demo.actusfrf.org:8080](https://demo.actusfrf.org:8080/) and there is no option to change this. 3. The ‘Interest Rate Scenarios’ tab displays the market risk scenario data available in the demo - Clicking on the ‘Choose a dataset’ dropdown allows you to select a different interest rate scenario from: (1) steady rates, (2) decreasing rates (3) recovering rates, and (4) increasing rates. - In each case, a plot of interest rates over time is shown: the y-axis is %pa interest rate; the x-axis is date. - Since this particular demo was developed in Sep 2022, the rates show before that date are historical rates. The plots for all four scenarios are identical up until that date. - The different interest scenarios correspond to different projections for future interest rates one might have made in September 2022. Hence the different scenario choice leads to very different projected interest rates after September 2022. - The historical data shown and the projected future rates are all for the rate on US 5-year Treasury bonds for the relevant date. This particular market index is used as the base rate (ACTUS contract term marketObjectCodeOfRateReset) of all variable rate contracts in the demo. When a Rate reset occurs on one of these variable rate contracts, the new rate is computed as: (projected or actual base rate for this simulated time) + rateSpread for this variable rate contract. 4. The ‘Loan Contract Cashflow’ tab displays the computed cashflows for one ACTUS contract - The terms of the ACTUS contract being simulated are shown on the left side of the display. - It is possible to change the terms of the contract and the interest rate scenario being used for the simulation with the controls and term specifications on the left side. - You can select (1) a PAM or an ANN contract type, (2) an issue date, (3) a maturity, (4) a loan amount, (5) a starting (or fixed) interest rate, (6) a payment frequency, (7) a Rate Reset Frequency (setting this = ‘Fixed Rate’ implies no Rate Resetting), (8) the rate reset spread, and (9) the interest Scenario. - Changing any of these contract or risk factor parameters will reactively cause the cashflows of the contract to be recomputed. There may be up to 2-3 seconds of delay with an in-process icon displayed, then the new cashflow will be shown on the right side of the display. - If the contract currently selected is Fixed Rate, changing the interest rate scenario will cause a new cashflow to be computed but the resulting values will be unchanged; if the contract is variable rate, different interest rate scenarios will result in visibly different cashflows. - The generated cashflow results are shown on the right side of the display in two forms. At the top is a graphical representation in the same format as that used in the Sample ACTUS Contract Cashflows Demo, with the x-axis representing time and arrows showing the direction of payments at different times. Red arrows are for Principal payments and green ones for interest payments. Accrued levels of principal and interest are displayed as dotted lines. - A tabular listing of the generated cashflow events with date, event type, and event parameters is displayed below the graphical representation. The event types are described in the ACTUS data dictionary at [https://github.com/actusfrf/actus-dictionary/blob/master/actus-dictionary-event.json](https://github.com/actusfrf/actus-dictionary/blob/master/actus-dictionary-event.json) 5. The ‘Portfolio Analysis’ tab will report on the income and liquidity over time of a portfolio of ACTUS contracts. - On the left side of the display, it is possible to select (1) either a portfolio of PAM or a portfolio of ANN contracts, (2) the type of analysis to perform and display, and (3) the (Interest rate) risk factor scenario to use for this report. - A view of some of the contract terms of the selected portfolio is shown in the lower part of the display on the right side of the page. Due to technical issues with the display in Rshiny of detailed tables, only the first 8 terms of each contract are shown. - The complete CSV files, AnnuityPortfolio.csv and BondPortfolio.csv are available along with the posting of this document. They can be viewed using a text editor or more conveniently by importing them into MS Excel. When CSV files are imported into Excel, date valued fields may be converted into something other than the ISO standard date format expected by the ACTUS server. - You can choose a Risk Factor/Interest Scenario to use for the portfolio simulation and report as any of the four scenarios displayed in the ‘Interest Rate Scenario’ tab. - The income report generated and displayed as output of the analysis on the right part of the display is a sum of the total interest income for the portfolio, month by month. It can be displayed in that form, or as a cumulative total income from the status date of the portfolio. - The liquidity report generated and displayed as output is the net sum of interest paid and principal movements computed month by month from the portfolio aggregated cashflows. Like the income analysis, the liquidity report can be displayed as raw month by month values or as a cumulative total from the status date of the portfolio. 6. The ‘Uploaded Portfolio Analysis’ allows you to upload a portfolio of ACTUS contracts from your workstation and perform the same analyses as in the ‘Portfolio Analysis’ tab. - The format of the uploaded files must match the format of the example files AnnuityPortfolio.csv and BondPortfolio.csv. Mixed files with both PAM and ANN contracts are of course permitted. - Click on the ‘Browse’ button. It will open a window to allow you to select a file on your workstation. Clicking on ‘open’ will then (up)load that portfolio into the demo. If the file is a correctly formatted CSV file of ACTUS contracts, the analysis selected by the current choices for analysis type and Risk factor scenario will be performed and displayed. - Uploading Portfolio files which have been or will be edited with Microsoft Excel. - This is possible but to avoid Excel reformatting date fields in an somewhat unpredictable way, values for all date attributes of a contract must be entered in the format ‘yyyy-mm-dd’. In other words, they must start with a blank space character and then be in yyyy-mm-dd form. This forces Excel to assume that there are character string data and NOT dates – hence it leaves them alone. The files BondPortfolioX.csv and AnnuityPortfolioX.csv, which are available as sample files in the DaDFiR3demo git repository, have this property and can be uploaded into the demo and analyzed.

## Improvements which should be made to this demo

- Add more contract types and some 30-year mortgages to the sample portfolios; this will require extending the interest rate scenarios further into the future.
- Make the full CSV portfolio files directly visible completely within the demo.
- Add to the demo some use of non-market risk factors – prepayment, default, deposit/withdrawal transactions available in the ACTUS-webapp server.
